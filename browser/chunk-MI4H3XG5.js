import{a as k,q as G}from"./chunk-OT5C62IN.js";var T="http://www.w3.org/2001/XMLSchema";function C(o){let e=(o||"").toLowerCase();return/^(xs:date|xs:datetime|xs:gyearmonth|xs:gyear|xs:time)$/.test(e)}function U(o){let e={};for(let n of Array.from(o.children)){if(n.namespaceURI!==T)continue;let r=n,s=r.getAttribute("value")??"";switch(r.localName){case"minInclusive":e.minInclusive=s;break;case"maxInclusive":e.maxInclusive=s;break;case"minExclusive":e.minExclusive=s;break;case"maxExclusive":e.maxExclusive=s;break;case"pattern":e.pattern=s;break;case"enumeration":(e.enums??=[]).push(s);break}}return e}function Z(o,e){let n=e.match(/\/st:([A-Za-z_][\w.-]*)/g),r=n?n[n.length-1].replace("/st:",""):void 0;if(r){let s=Array.from(o.getElementsByTagNameNS(T,"simpleType")).find(c=>c.getAttribute("name")===r);if(s)return Array.from(s.children).find(c=>c.namespaceURI===T&&c.localName==="restriction")||null}if(/\/st:inline/.test(e)){let s=e.match(/\/el:([A-Za-z_][\w.-]*)/g),c=s?s[s.length-1].replace("/el:",""):void 0;if(c){let a=Array.from(o.getElementsByTagNameNS(T,"element")).find(i=>i.getAttribute("name")===c);if(a){let i=Array.from(a.children).find(m=>m.namespaceURI===T&&m.localName==="simpleType");if(i)return Array.from(i.children).find(m=>m.namespaceURI===T&&m.localName==="restriction")||null}}}return null}function B(o){let e={};for(let n of Array.from(o.children)){if(n.namespaceURI!==T)continue;let r=n,s=r.getAttribute("value")??"";switch(r.localName){case"minInclusive":e.minInclusive=Number(s);break;case"maxInclusive":e.maxInclusive=Number(s);break;case"minExclusive":e.minExclusive=Number(s);break;case"maxExclusive":e.maxExclusive=Number(s);break;case"totalDigits":e.totalDigits=Number(s);break;case"fractionDigits":e.fractionDigits=Number(s);break;case"pattern":e.pattern=s;break;case"enumeration":(e.enums??=[]).push(s);break}}return e}function O(o){if(!o)return;let e=o.match(/(\d+)(?!.*\d)/);if(!e)return;let n=Number(e[1]);return Number.isFinite(n)?n:void 0}function X(o){let e=o?Array.isArray(o)?o:[o]:[];if(!e.length)return;let n=/\\d\{(\d+)(?:,(\d+))?\}/g,r,s;for(let i of e){let m;for(;(m=n.exec(i))!==null;){let f=Number(m[1]),d=m[2]!==void 0?Number(m[2]):f;r=r===void 0?f:Math.min(r,f),s=s===void 0?d:Math.max(s,d)}}if(r===void 0&&s===void 0)return;let c=((r??1)>=1,0),a=s!==void 0?Math.pow(10,s)-1:void 0;return{min:c,max:a}}function j(o){let e=o?Array.isArray(o)?o:[o]:[];if(!e.length)return;let n=/[{]([0-9]+)(?:,([0-9]+))?[}]/g,r,s;for(let c of e){let a;for(;(a=n.exec(c))!==null;){let i=Number(a[1]),m=a[2]!==void 0?Number(a[2]):i;r=r===void 0?i:Math.min(r,i),s=s===void 0?m:Math.max(s,m)}}if(!(r===void 0&&s===void 0))return{minLength:r,maxLength:s}}var g="http://www.w3.org/2001/XMLSchema",q=class o{buildEventoTree(e,n){let r=M(e),s=M(n),c=I(r),a=I(s),i=this.indexGlobal(c),m=this.indexGlobal(a),f=this.mergeIndexes(m,i);f.docs=[s,r];let d=W(r);if(!d)throw new Error("Elemento raiz do evento n\xE3o encontrado.");let b="schema:evento",E=[this.buildElementNode(d,f,`${b}/el:${y(d)}`,new Set)];return{id:b,name:d.getAttribute("name")||"evt",kind:"schema",children:E}}buildTiposTree(e){let n=M(e),r=I(n),s="schema:tipos",c=this.indexGlobal(r);c.docs=[n];let a=[];for(let i of Array.from(r.children))i.namespaceURI===g&&(i.localName==="complexType"?a.push(this.buildComplexTypeNode(i,c,`${s}/ct:${y(i)}`,new Set)):i.localName==="simpleType"?a.push(this.buildSimpleTypeNode(i,`${s}/st:${y(i)}`,c,new Set)):(i.localName==="group"||i.localName==="attributeGroup")&&a.push({id:`${s}/${i.localName}:${y(i)}`,name:`${i.localName} ${y(i)||""}`.trim(),kind:i.localName,children:[]}));return{id:s,name:"tipos.xsd",kind:"schema",children:a}}indexGlobal(e){let n=new Map,r=new Map,s=new Map,c=new Map;for(let a of Array.from(e.children)){if(a.namespaceURI!==g)continue;let i=a.getAttribute("name");if(i)switch(a.localName){case"complexType":n.set(i,a);break;case"simpleType":r.set(i,a);break;case"group":s.set(i,a);break;case"attributeGroup":c.set(i,a);break}}return{complex:n,simple:r,groups:s,attrGroups:c,docs:[]}}mergeIndexes(e,n){let r=(s,c)=>{let a=new Map(s);for(let[i,m]of c)a.has(i)||a.set(i,m);return a};return{complex:r(e.complex,n.complex),simple:r(e.simple,n.simple),groups:r(e.groups,n.groups),attrGroups:r(e.attrGroups,n.attrGroups),docs:[...e.docs,...n.docs]}}buildElementNode(e,n,r,s){let c=y(e)||"(element)",a=[],i={},m=e.getAttribute("minOccurs"),f=e.getAttribute("maxOccurs");(m||f)&&(i.occurs={min:m?Number(m):1,max:f==="unbounded"?"unbounded":f?Number(f):1});let d=v(e);d.length&&(i.docs=d);let b=x(e,"complexType");b&&a.push(this.buildComplexTypeNode(b,n,`${r}/ct:inline`,new Set(s)));let E=x(e,"simpleType");if(E){let t=this.buildSimpleTypeNode(E,`${r}/st:inline`,n,new Set(s));a.push(t),t.meta?.base&&(i.base=t.meta.base)}let N=e.getAttribute("type");if(N){i.typeName=N;let t=L(N);if(n.complex.has(t)&&!s.has(`ct:${t}`)){let u=new Set(s);u.add(`ct:${t}`),a.push(this.buildComplexTypeNode(n.complex.get(t),n,`${r}/ct:${t}`,u))}else if(n.simple.has(t)&&!s.has(`st:${t}`)){let u=new Set(s);u.add(`st:${t}`);let l=this.buildSimpleTypeNode(n.simple.get(t),`${r}/st:${t}`,n,u);a.push(l),l.meta?.base&&(i.base=l.meta.base),!i.base&&l.meta?.base&&(i.base=l.meta.base)}else{let u=R(n.docs,"complexType",t),l=!u&&R(n.docs,"simpleType",t);if(u&&!s.has(`ct:${t}`)){let p=new Set(s);p.add(`ct:${t}`),a.push(this.buildComplexTypeNode(u,n,`${r}/ct:${t}`,p))}else if(l&&!s.has(`st:${t}`)){let p=new Set(s);p.add(`st:${t}`);let h=this.buildSimpleTypeNode(l,`${r}/st:${t}`,n,p);a.push(h),!i.base&&h.meta?.base&&(i.base=h.meta.base)}else a.push({id:`${r}/type:${N}`,name:`type ${N}`,kind:"type",children:[]})}}let $={id:r,name:c,kind:"element",children:a};return Object.keys(i).length&&($.meta=i),$}buildComplexTypeNode(e,n,r,s){let c=e.getAttribute("name")||"(complexType)",a=[],i={},m=v(e);m.length&&(i.docs=m);let f=e,d=x(e,"complexContent");if(d){let t=x(d,"extension")||x(d,"restriction");if(t){let u=t.getAttribute("base");u&&a.push({id:`${r}/base:${u}`,name:`base ${u}`,kind:"type",children:[]}),f=t}else f=d}let b=x(f,"sequence")||x(f,"choice")||x(f,"all");if(b){let t=new Set(s);a.push(this.buildGroupNode(b,n,`${r}/${b.localName}`,t))}let E=Array.from(e.children).filter(t=>t.namespaceURI===g&&t.localName==="attribute"),N=Array.from(e.children).filter(t=>t.namespaceURI===g&&t.localName==="attributeGroup");if(E.length||N.length){let t={id:`${r}/attributes`,name:"attributes",kind:"attributes",children:[]};for(let u of E){let l=y(u)||"(attribute)",p={},h=[],D=v(u);D.length&&(p.docs=D);let F=u.getAttribute("use");F&&(p.use=F);let A=u.getAttribute("type");if(A){p.typeName=A;let w=L(A);if(n.simple.has(w)){let S=this.buildSimpleTypeNode(n.simple.get(w),`${t.id}/${l}/st:${w}`,n,new Set);h.push(S),S.meta?.base&&(p.base=S.meta.base)}else if(n.complex.has(w)){let S=this.buildComplexTypeNode(n.complex.get(w),n,`${t.id}/${l}/ct:${w}`,new Set);h.push(S)}else h.push({id:`${t.id}/${l}/type:${A}`,name:`type ${A}`,kind:"type",children:[]})}t.children.push({id:`${t.id}/${l}`,name:l,kind:"attribute",children:h,meta:p})}for(let u of N){let l=u.getAttribute("ref")||"";t.children.push({id:`${t.id}/attrGroup:${l}`,name:`attributeGroup ${l}`,kind:"attributeGroup",children:[]})}a.push(t)}let $={id:r,name:c,kind:"complexType",children:a};return i.docs?.length&&($.meta=i),$}buildGroupNode(e,n,r,s){let c={id:r,name:e.localName,kind:e.localName,children:[]};for(let a of Array.from(e.children))if(a.namespaceURI===g){if(a.localName==="element"){c.children.push(this.buildElementNode(a,n,`${r}/el:${y(a)}`,new Set(s)));continue}if(a.localName==="sequence"||a.localName==="choice"||a.localName==="all"){c.children.push(this.buildGroupNode(a,n,`${r}/${a.localName}`,new Set(s)));continue}if(a.localName==="group"){let i=a.getAttribute("ref")||"";c.children.push({id:`${r}/group:${i}`,name:`group ${i}`,kind:"group",children:[]});continue}}return c}buildSimpleTypeNode(e,n,r,s=new Set){let c=e.getAttribute("name")||"(simpleType)",a=[],i,m={},f=v(e);f.length&&(m.docs=f);let d=x(e,"restriction");if(d){if(i=d.getAttribute("base")||void 0,m.base=i,!!i?.toLowerCase().match(/^xs:(byte|short|int|integer|long|nonnegativeinteger|nonpositiveinteger|positiveinteger|negativeinteger|unsignedByte|unsignedShort|unsignedInt|unsignedLong|decimal)$/)){let t=B(d);Object.keys(t).length&&(m.numericFacets=t);let u=t.minInclusive!==void 0||t.minExclusive!==void 0,l=t.maxInclusive!==void 0||t.maxExclusive!==void 0;if((!u||!l)&&(t.pattern||t.enums?.length)){let p=X(t.pattern?[t.pattern]:void 0);p&&(m.inferred=k(k({},m.inferred||{}),p))}t.enums?.length&&(m.hasNumericEnums=!0)}if(i&&C(i)){let t=U(d);Object.keys(t).length&&(m.dateFacets=t),t.enums?.length&&(m.hasDateEnums=!0)}if(i&&i.toLowerCase().endsWith(":string")){let t=V(d);if((t.length||t.minLength||t.maxLength||t.patterns?.length)&&(m.stringFacets=t),!t.length&&!t.maxLength){let l=O(y(e));l!==void 0&&(m.inferred={maxLengthFromName:l})}if(!(t.length||t.minLength||t.maxLength)&&t.patterns?.length){let l=j(t.patterns);l&&(m.inferred=k({},l))}}let N=v(d);N.length&&(m.docs=[...m.docs||[],...N]),i=d.getAttribute("base")||void 0,m.base=i;for(let t of Array.from(d.children)){if(t.namespaceURI!==g)continue;let u=t.localName;if(["enumeration","pattern","length","minLength","maxLength","totalDigits","fractionDigits","minInclusive","maxInclusive","minExclusive","maxExclusive"].includes(u)){if(u==="enumeration")continue;let l=t.getAttribute("value")||"";a.push({id:`${n}/${u}:${l}`,name:`${u}: ${l}`,kind:u,children:[]})}}let $=Array.from(d.children).filter(t=>t.namespaceURI===g&&t.localName==="enumeration");if($.length){let t={id:`${n}/enumeration`,name:"enumeration",kind:"enumeration",children:[]};for(let u of $){let l=u.getAttribute("value")||"(enum)",p=v(u),h={id:`${t.id}/${l}`,name:l,kind:"enumValue",children:[]};p.length&&(h.meta={docs:p}),t.children.push(h)}a.push(t)}if(i){let t=L(i);if(!(/^xs?:/.test(i)||i.startsWith("xs:")||i==="string"||i==="byte")&&!s.has(`st:${t}`)){let l=r.simple.get(t)||R(r.docs,"simpleType",t);if(l){let p=new Set(s);p.add(`st:${t}`);let h=this.buildSimpleTypeNode(l,`${n}/st:${t}`,r,p);a.unshift(h)}else a.unshift({id:`${n}/type:${i}`,name:`type ${i}`,kind:"type",children:[]})}}}let b={id:n,name:c,kind:"simpleType",children:a};return Object.keys(m).length&&(b.meta=m),b}static \u0275fac=function(n){return new(n||o)};static \u0275prov=G({token:o,factory:o.\u0275fac,providedIn:"root"})};function V(o){let e="http://www.w3.org/2001/XMLSchema",n={};for(let r of Array.from(o.children)){if(r.namespaceURI!==e)continue;let s=r,c=s.getAttribute("value");switch(s.localName){case"length":n.length=c?Number(c):void 0;break;case"minLength":n.minLength=c?Number(c):void 0;break;case"maxLength":n.maxLength=c?Number(c):void 0;break;case"pattern":(n.patterns??=[]).push(c??"");break}}return n}function v(o){let e=[];for(let n of Array.from(o.children))if(!(n.namespaceURI!==g||n.localName!=="annotation")){for(let r of Array.from(n.children))if(r.namespaceURI===g&&r.localName==="documentation"){let s=(r.textContent||"").trim().replace(/\s+/g," ");s&&e.push(s)}}return e}var z=new Set(["complexType","sequence","choice","all","attributes"]);function P(o,e=z){let n={id:o.id,name:o.name,kind:o.kind,source:o,meta:o.meta?k({},o.meta):void 0,children:[]};if(!o.children?.length)return n;for(let r of o.children)if(e.has(r.kind)){let s=P(r,e).children??[];for(let c of s)n.children.push(c)}else n.children.push(P(r,e));return n}function M(o){let e=new DOMParser().parseFromString(o,"application/xml"),n=e.querySelector("parsererror");if(n)throw new Error("XML inv\xE1lido: "+n.textContent);return e}function I(o){let e=o.getElementsByTagNameNS(g,"schema")?.[0];if(e)return e;if(o.documentElement?.localName==="schema")return o.documentElement;throw new Error("Root <schema> n\xE3o encontrado.")}function W(o){let e=I(o);for(let n of Array.from(e.children))if(n.namespaceURI===g&&n.localName==="element")return n;return null}function x(o,e){for(let n of Array.from(o.children))if(n.namespaceURI===g&&n.localName===e)return n;return null}function y(o){return o.getAttribute("name")||o.getAttribute("ref")||""}function L(o){let e=o.indexOf(":");return e>=0?o.slice(e+1):o}function R(o,e,n){for(let r of o){let s=r.getElementsByTagNameNS(g,e);for(let c of Array.from(s))if(c.getAttribute("name")===n)return c}return null}export{T as a,Z as b,q as c,P as d};
